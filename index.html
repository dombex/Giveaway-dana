<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Giveaway Pro - Verified Only</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{ 
    background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url("IMG1.jpg") center/cover no-repeat fixed; 
    font-family: 'Segoe UI', Arial, sans-serif; color:#fff; text-align:center; margin:0; padding:15px; 
}
.progress-container { width: 100%; background: #333; height: 6px; position: fixed; top: 0; left: 0; z-index: 1001; }
#progressBar { width: 0%; height: 100%; background: #1e90ff; transition: 0.5s; }
.container{ max-width:360px; margin:auto; }
.card{ background:rgba(20,20,20,0.95); border-radius:16px; padding:18px; margin:12px 0; text-align:left; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
.card b{ font-size:14px; color: #1e90ff; display: block; margin-bottom: 5px; }

/* Timer Style */
.timer-box { background: rgba(255, 204, 0, 0.1); border: 1px solid #ffcc00; border-radius: 12px; padding: 10px; margin-bottom: 15px; color: #ffcc00; font-weight: bold; }
#timer { font-size: 20px; letter-spacing: 2px; }

/* Status & Messages */
.success-box {
    display: none;
    background: rgba(40, 167, 69, 0.15);
    border: 1px solid #28a745;
    border-radius: 12px;
    padding: 15px;
    margin-top: 15px;
    color: #2ecc71;
    font-size: 13px;
    font-weight: bold;
    animation: fadeIn 0.5s ease;
    text-align: center;
}
@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

.disclaimer-box { 
    background: rgba(30, 144, 255, 0.1); border: 1px solid #1e90ff; border-radius: 12px; 
    padding: 15px; margin-top: 25px; margin-bottom: 40px; text-align: left;
}
.disclaimer-box b { color: #1e90ff; display: block; margin-bottom: 5px; font-size: 14px; }
.disclaimer-box p { font-size: 12px; color: #ccc; margin: 0; line-height: 1.5; }

input,button{ width:100%; padding:12px; border-radius:10px; border:none; margin-top:10px; font-size:14px; box-sizing: border-box; }
input{ background:#000; color:#fff; border:1px solid #333; }
input:disabled{ background:#222; color:#666; }
button{ background: linear-gradient(90deg,#1e90ff,#00bfff); color:#fff; font-weight:bold; cursor:pointer; transition: 0.3s; }
button:disabled{ background:#333 !important; opacity: 0.6; cursor:not-allowed; }

/* Loader Spinner */
.loader {
    width: 16px; height: 16px; border: 2px solid #fff; border-bottom-color: transparent;
    border-radius: 50%; display: inline-block; animation: rotation 1s linear infinite; margin-right: 8px;
    vertical-align: middle;
}
@keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

.header-img{ width:120px; border-radius:12px; margin:10px auto; display:block; }
.blocked-container { padding-top: 80px; }
.img-blocked { width: 180px; border-radius: 15px; margin: 20px auto; display: block; border: 3px solid #ff4444; }
.hp-field { display: none !important; }
</style>
</head>
<body>

<div class="progress-container"><div id="progressBar"></div></div>

<div id="main-app">
    <h1>Tugas Giveaway</h1>
    
    <div class="container">
        <div class="timer-box">
            <div style="font-size: 11px; text-transform: uppercase;">Berakhir Dalam:</div>
            <div id="timer">00:00:00</div>
        </div>
    </div>

    <a href="https://xno.click/9Lj1gP" target="_blank">
        <img src="IMG1.jpg" alt="Bags" class="header-img">
    </a>

    <div class="container" id="taskList"></div>

    <div class="container">
      <div class="card">
        <b>üí∞ NOMOR DANA</b>
        <div class="hp-field"><input type="text" id="bot_trap" tabindex="-1"></div>
        <input id="wallet" type="number" placeholder="Selesaikan tugas dulu..." disabled>
        <button id="walletBtn" disabled>Klaim Saldo DANA</button>
        <div id="successMessage" class="success-box">
            ‚úÖ Tugas telah selesai! Kami akan mereviewnya segera. Semoga beruntung!
        </div>
      </div>
    </div>

    <div class="container">
        <div class="disclaimer-box">
            <b>‚ÑπÔ∏è INFORMASI GIVEAWAY</b>
            <p>Giveaway akan diundi pada tanggal <b>27 Februari 2026</b>. Pastikan kamu memenuhi syarat dan mengisi form dengan benar. Semoga beruntung!</p>
        </div>
    </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz48kHVsckM7JKqZbjFPCisO0OdV6XOJUh_svTHVnsn4Op5cEgbYoVR9df02R0l0-__Bw/exec";
const SUBMITTED_KEY = "giveaway_v1_submitted";
const STORAGE_KEY = "giveaway_v1_state";
const TIMER_END_KEY = "giveaway_timer_end";

function startTimer(display) {
    let endTime = localStorage.getItem(TIMER_END_KEY);
    if (!endTime) {
        endTime = Math.floor(Date.now() / 1000) + (72 * 60 * 60);
        localStorage.setItem(TIMER_END_KEY, endTime);
    }
    setInterval(function () {
        let now = Math.floor(Date.now() / 1000);
        let remaining = endTime - now;
        if (remaining <= 0) {
            display.textContent = "BERAKHIR";
            document.getElementById("walletBtn").disabled = true;
            return;
        }
        let h = Math.floor(remaining / 3600);
        let m = Math.floor((remaining % 3600) / 60);
        let s = Math.floor(remaining % 60);
        display.textContent = (h<10?"0":"")+h+":"+(m<10?"0":"")+m+":"+(s<10?"0":"")+s;
    }, 1000);
}

window.onload = function () {
    startTimer(document.querySelector('#timer'));
};

if(localStorage.getItem(SUBMITTED_KEY)) {
    document.body.innerHTML = `<div class="blocked-container"><h2 style="color:#ff4444;">Jangan Curang üö´</h2><img src="IMG3.jpg" alt="Blocked" class="img-blocked"><p>Satu perangkat hanya berlaku untuk satu kali klaim.</p></div>`;
}

let appState = JSON.parse(localStorage.getItem(STORAGE_KEY)) || { doneTasks: [], username: "", commentLink: "" };

const tasks = [
  {id:"follow", title:"1. Username X (Wajib Verified)", link:"https://xno.click/9Lj1gP", type:"text", placeholder:"Ex: @budisatrio"},
  {id:"followProof", title:"2. Screenshot Follow & Notif", type:"file"},
  {id:"like", title:"3. Screenshot Like & RT Pinned", type:"file"},
  {id:"comment", title:"4. Link Komentar Pinned Post", link:"https://xno.click/RRG2z2", type:"url", placeholder:"https://x.com/.../status/..."}
];

const taskList = document.getElementById("taskList");

tasks.forEach((t)=>{
    const isDone = appState.doneTasks.includes(t.id);
    const card = document.createElement("div");
    card.className="card";
    let inputHTML = t.type==="file" ? `<input type="file" accept="image/*" ${isDone?'disabled':''}>` : `<input value="${t.id==='follow'?appState.username:(t.id==='comment'?appState.commentLink:'')}" placeholder="${t.placeholder||''}" ${isDone?'disabled':''}>`;
    
    card.innerHTML = `<b>${t.title}</b>${t.link ? `<a href="${t.link}" target="_blank" style="font-size:11px; color:#00bfff;">KLIK TUGAS ‚Üó</a>` : ''}${inputHTML}<button class="verify-btn" ${isDone?'disabled style="background:#28a745"':''}>${isDone ? 'Berhasil ‚úì' : 'Verifikasi'}</button>`;
    
    const btn = card.querySelector(".verify-btn");
    const inp = card.querySelector("input");

    btn.onclick = () => {
        const val = inp.value.trim();
        if(t.type==="file" && inp.files.length===0) return alert("Upload bukti!");
        if(t.type!=="file" && val === "") return alert("Isi data!");
        
        if(t.id === "follow" && val.includes("http")) return alert("Hanya username saja!");
        if(t.id === "comment") {
            const match = val.match(/\/(x|twitter)\.com\/([^\/]+)\/status/);
            if(!match || match[2].toLowerCase() !== appState.username) return alert("Username di link tidak sesuai dengan Tugas 1!");
        }

        btn.disabled = true;
        btn.innerHTML = `<span class="loader"></span> Memproses...`;

        setTimeout(() => {
            if(t.id === "follow") appState.username = val.replace('@', '').toLowerCase();
            if(t.id === "comment") appState.commentLink = val;
            
            btn.innerHTML = "Berhasil ‚úì";
            btn.style.background = "#28a745";
            inp.disabled = true;
            appState.doneTasks.push(t.id);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appState));
            updateUI();
        }, 1500);
    };
    taskList.appendChild(card);
});

function updateUI(){
    const doneCount = appState.doneTasks.length;
    document.getElementById("progressBar").style.width = (doneCount / tasks.length) * 100 + "%";
    if(doneCount === tasks.length){ 
        document.getElementById("wallet").disabled = false; 
        document.getElementById("walletBtn").disabled = false; 
    }
}

const toBase64 = file => new Promise((res) => {
    const reader = new FileReader(); 
    reader.readAsDataURL(file);
    reader.onload = () => res(reader.result.split(',')[1]);
});

document.getElementById("walletBtn").onclick = async () => {
    if(document.getElementById("bot_trap").value !== "") return;
    const w = document.getElementById("wallet").value;
    if(w.length < 10) return alert("Nomor DANA salah!");
    
    const btn = document.getElementById("walletBtn");
    const successBox = document.getElementById("successMessage");
    
    btn.disabled = true;
    btn.innerHTML = `<span class="loader"></span> Mengirim...`;
    
    try {
        const fileInput = document.querySelector('input[type="file"]');
        const imageBase64 = await toBase64(fileInput.files[0]);
        
        await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ username: appState.username, wallet: w, link: appState.commentLink, image: imageBase64 })
        });

        successBox.style.display = "block";
        btn.innerHTML = "Berhasil Terkirim ‚úì";
        btn.style.background = "#28a745";

        setTimeout(() => {
            localStorage.setItem(SUBMITTED_KEY, "true");
            location.reload();
        }, 3500);
    } catch (e) {
        alert("Gagal mengirim! Coba lagi.");
        btn.innerHTML = "Klaim Saldo DANA";
        btn.disabled = false;
    }
};

updateUI();
</script>
</body>
</html>
